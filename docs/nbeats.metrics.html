---

title: N-Beats metrics

keywords: fastai
sidebar: home_sidebar

summary: "A basic architecture for time series forecasting."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_nbeats.metrics.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Metrics">Metrics<a class="anchor-link" href="#Metrics">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dct</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:{</span><span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;foo2&#39;</span><span class="p">:{</span><span class="s1">&#39;foo3&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span><span class="s1">&#39;ignore&#39;</span><span class="p">:{</span><span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">}}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">_get_key_from_nested_dct</span><span class="p">(</span><span class="n">dct</span><span class="p">,</span><span class="s1">&#39;bar&#39;</span><span class="p">,[</span><span class="s1">&#39;ignore&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">r</span><span class="p">,{</span><span class="s1">&#39;foobar&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NBeatsTheta" class="doc_header"><code>class</code> <code>NBeatsTheta</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/nbeats/metrics.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NBeatsTheta</code>() :: <code>Metric</code></p>
</blockquote>
<p>The sqaure of the <code>theta</code> for every block.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span><span class="mi">10</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">550</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span><span class="o">-</span><span class="mi">56</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:])</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_items</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">horizon</span> <span class="o">=</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">after_batch</span> <span class="o">=</span> <span class="n">NormalizeTS</span><span class="p">()</span>
                               <span class="p">)</span>

<span class="n">mdl</span> <span class="o">=</span> <span class="n">NBeatsNet</span><span class="p">(</span><span class="n">device</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">stack_types</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;trend&#39;</span><span class="p">,</span><span class="s1">&#39;seasonality&#39;</span><span class="p">),</span> <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">)</span>
<span class="n">loss_func</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span> <span class="n">Adam</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">NBeatsTheta</span><span class="p">()],</span>
               <span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">),</span><span class="n">Tensor</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train:89; Valid: 33; Test 3
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>theta</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>6.631732</td>
      <td>26.515820</td>
      <td>None</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-8-4535a9aaaa55&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span>                )
<span class="ansi-green-intense-fg ansi-bold">     10</span> 
<span class="ansi-green-fg">---&gt; 11</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">.1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span> test_eq<span class="ansi-blue-fg">(</span>type<span class="ansi-blue-fg">(</span>learn<span class="ansi-blue-fg">.</span>metrics<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>Tensor<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span>                         self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch<span class="ansi-blue-fg">;</span>          self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_epoch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    294</span>                         self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 295</span><span class="ansi-red-fg">                         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>                     <span class="ansi-green-fg">except</span> CancelEpochException<span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_epoch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    297</span>                     <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>                       self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_epoch&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_validate</span><span class="ansi-blue-fg">(self, ds_idx, dl)</span>
<span class="ansi-green-intense-fg ansi-bold">    277</span>             dl<span class="ansi-blue-fg">,</span>old<span class="ansi-blue-fg">,</span>has <span class="ansi-blue-fg">=</span> change_attrs<span class="ansi-blue-fg">(</span>dl<span class="ansi-blue-fg">,</span> names<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">[</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    278</span>             self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> dl<span class="ansi-blue-fg">;</span>                                    self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_validate&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 279</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">with</span> torch<span class="ansi-blue-fg">.</span>no_grad<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    280</span>         <span class="ansi-green-fg">except</span> CancelValidException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_validate&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    281</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    245</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    246</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 247</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    248</span> 
<span class="ansi-green-intense-fg ansi-bold">    249</span>     <span class="ansi-green-fg">def</span> one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> i<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">one_batch</span><span class="ansi-blue-fg">(self, i, b)</span>
<span class="ansi-green-intense-fg ansi-bold">    259</span>             self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>zero_grad<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    260</span>         <span class="ansi-green-fg">except</span> CancelBatchException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_batch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 261</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>                                             self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_batch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> 
<span class="ansi-green-intense-fg ansi-bold">    263</span>     <span class="ansi-green-fg">def</span> _do_begin_fit<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> n_epoch<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    226</span>     <span class="ansi-green-fg">def</span> ordered_cbs<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> cb_func<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>cb <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>cb<span class="ansi-blue-fg">,</span> cb_func<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    227</span> 
<span class="ansi-green-fg">--&gt; 228</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> L<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_call_one<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    230</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">map</span><span class="ansi-blue-fg">(self, f, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    360</span>              <span class="ansi-green-fg">else</span> f<span class="ansi-blue-fg">.</span>format <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span>str<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    361</span>              else f.__getitem__)
<span class="ansi-green-fg">--&gt; 362</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>map<span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    363</span> 
<span class="ansi-green-intense-fg ansi-bold">    364</span>     <span class="ansi-green-fg">def</span> filter<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">_new</span><span class="ansi-blue-fg">(self, items, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    313</span>     <span class="ansi-blue-fg">@</span>property
<span class="ansi-green-intense-fg ansi-bold">    314</span>     <span class="ansi-green-fg">def</span> _xtra<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">--&gt; 315</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> _new<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> items<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> type<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> use_list<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    316</span>     <span class="ansi-green-fg">def</span> __getitem__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_get<span class="ansi-blue-fg">(</span>idx<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> is_indexer<span class="ansi-blue-fg">(</span>idx<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> L<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_get<span class="ansi-blue-fg">(</span>idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> use_list<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    317</span>     <span class="ansi-green-fg">def</span> copy<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">.</span>copy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(cls, x, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     39</span>             <span class="ansi-green-fg">return</span> x
<span class="ansi-green-intense-fg ansi-bold">     40</span> 
<span class="ansi-green-fg">---&gt; 41</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     42</span>         res<span class="ansi-blue-fg">.</span>_newchk <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">0</span>
<span class="ansi-green-intense-fg ansi-bold">     43</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, items, use_list, match, *rest)</span>
<span class="ansi-green-intense-fg ansi-bold">    304</span>         <span class="ansi-green-fg">if</span> items <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> items <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    305</span>         <span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">(</span>use_list <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> <span class="ansi-green-fg">not</span> _is_array<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 306</span><span class="ansi-red-fg">             </span>items <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> use_list <span class="ansi-green-fg">else</span> _listify<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    307</span>         <span class="ansi-green-fg">if</span> match <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    308</span>             <span class="ansi-green-fg">if</span> is_coll<span class="ansi-blue-fg">(</span>match<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> match <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>match<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">_listify</span><span class="ansi-blue-fg">(o)</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span>     <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> o
<span class="ansi-green-intense-fg ansi-bold">    241</span>     <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> _is_array<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 242</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">if</span> is_iter<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> list<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span>     <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> 

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span>             <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">,</span>_Arg<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> args<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    207</span>         fargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>args<span class="ansi-blue-fg">[</span>x<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> _Arg<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> x <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>pargs<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>maxi<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 208</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>fn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>fargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    209</span> 
<span class="ansi-green-intense-fg ansi-bold">    210</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_call_one</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    230</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 231</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">[</span>cb<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    232</span> 
<span class="ansi-green-intense-fg ansi-bold">    233</span>     <span class="ansi-green-fg">def</span> _bn_bias_state<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> bn_bias_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    230</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 231</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">[</span>cb<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    232</span> 
<span class="ansi-green-intense-fg ansi-bold">    233</span>     <span class="ansi-green-fg">def</span> _bn_bias_state<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> bn_bias_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">     23</span>         _run = (event_name not in _inner_loop or (self.run_train and getattr(self, &#39;training&#39;, True)) or
<span class="ansi-green-intense-fg ansi-bold">     24</span>                (self.run_valid and not getattr(self, &#39;training&#39;, False)))
<span class="ansi-green-fg">---&gt; 25</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>run <span class="ansi-green-fg">and</span> _run<span class="ansi-blue-fg">:</span> getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">,</span> noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span> 
<span class="ansi-green-intense-fg ansi-bold">     27</span>     <span class="ansi-green-fg">def</span> __setattr__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">after_batch</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    500</span>         <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span>
<span class="ansi-green-intense-fg ansi-bold">    501</span>         mets <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_train_mets <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>training <span class="ansi-green-fg">else</span> self<span class="ansi-blue-fg">.</span>_valid_mets
<span class="ansi-green-fg">--&gt; 502</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> met <span class="ansi-green-fg">in</span> mets<span class="ansi-blue-fg">:</span> met<span class="ansi-blue-fg">.</span>accumulate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>learn<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    503</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>training<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span>
<span class="ansi-green-intense-fg ansi-bold">    504</span>         self<span class="ansi-blue-fg">.</span>lrs<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>hypers<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;lr&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-7-d0d2ada32959&gt;</span> in <span class="ansi-cyan-fg">accumulate</span><span class="ansi-blue-fg">(self, learn)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>     <span class="ansi-green-fg">def</span> accumulate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> learn<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>         bs <span class="ansi-blue-fg">=</span> find_bs<span class="ansi-blue-fg">(</span>learn<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 7</span><span class="ansi-red-fg">         </span>theta_dct <span class="ansi-blue-fg">=</span> _get_key_from_nested_dct<span class="ansi-blue-fg">(</span>learn<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">.</span>dct<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;theta&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;bias&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;total&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;att&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span>         t <span class="ansi-blue-fg">=</span> torch<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span>tensor<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>v<span class="ansi-blue-fg">.</span>float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>abs<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> k<span class="ansi-blue-fg">,</span>v <span class="ansi-green-fg">in</span> theta_dct<span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span>         self<span class="ansi-blue-fg">.</span>total <span class="ansi-blue-fg">+=</span> to_detach<span class="ansi-blue-fg">(</span>t<span class="ansi-blue-fg">.</span>abs<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>bs

<span class="ansi-green-fg">&lt;ipython-input-5-7d3fdf2b3593&gt;</span> in <span class="ansi-cyan-fg">_get_key_from_nested_dct</span><span class="ansi-blue-fg">(dct, s_key, exclude, namespace)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-green-fg">def</span> _get_key_from_nested_dct<span class="ansi-blue-fg">(</span>dct<span class="ansi-blue-fg">,</span> s_key<span class="ansi-blue-fg">,</span> exclude <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> namespace<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>     r <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">}</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">for</span> key <span class="ansi-green-fg">in</span> dct<span class="ansi-blue-fg">.</span>keys<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>         <span class="ansi-green-fg">if</span> sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>exc <span class="ansi-green-fg">in</span> key <span class="ansi-green-fg">for</span> exc <span class="ansi-green-fg">in</span> exclude<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span> <span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>             <span class="ansi-green-fg">if</span> type<span class="ansi-blue-fg">(</span>dct<span class="ansi-blue-fg">[</span>key<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> dict<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">AttributeError</span>: &#39;NoneType&#39; object has no attribute &#39;keys&#39;</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_forward" class="doc_header"><code>get_forward</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/nbeats/metrics.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_forward</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_backward" class="doc_header"><code>get_backward</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/nbeats/metrics.py#L49" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_backward</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NBeatsBackwards" class="doc_header"><code>class</code> <code>NBeatsBackwards</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/nbeats/metrics.py#L55" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NBeatsBackwards</code>() :: <code>Metric</code></p>
</blockquote>
<p>The loss according to the <code>loss_func</code> on the backwards part of the time-serie.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NBeatsForward" class="doc_header"><code>class</code> <code>NBeatsForward</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/nbeats/metrics.py#L70" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NBeatsForward</code>() :: <code>Metric</code></p>
</blockquote>
<p>The loss according to the <code>loss_func</code> on the backwards part of the time-serie.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">17</span><span class="p">)[</span><span class="o">-</span><span class="mi">7</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([10, 11, 12, 13, 14, 15, 16])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span><span class="mi">10</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">550</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span><span class="o">-</span><span class="mi">56</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:])</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_items</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">horizon</span> <span class="o">=</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">after_batch</span> <span class="o">=</span> <span class="n">NormalizeTS</span><span class="p">()</span>
                             <span class="p">)</span>
<span class="n">mdl</span> <span class="o">=</span> <span class="n">NBeatsNet</span><span class="p">(</span><span class="n">device</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">)</span>
<span class="n">loss_func</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span> <span class="n">Adam</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">NBeatsBackwards</span><span class="p">(),</span> <span class="n">NBeatsForward</span><span class="p">()],</span>
               <span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="n">learn</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">learn</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train:89; Valid: 33; Test 3
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>b_loss</th>
      <th>f_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>421.622894</td>
      <td>1486.995850</td>
      <td>1981.619751</td>
      <td>780.390991</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>277.958618</td>
      <td>3.954545</td>
      <td>0.900000</td>
      <td>8.318182</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>201.884552</td>
      <td>3.954545</td>
      <td>0.900000</td>
      <td>8.318182</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>NBeatsBackwards tensor(1981.6198)
7
NBeatsForward tensor(780.3910)
NBeatsBackwards tensor(0.9000)
7
NBeatsForward tensor(8.3182)
NBeatsBackwards tensor(0.9000)
7
NBeatsForward tensor(8.3182)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-60-d5e3fc393d98&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> 
<span class="ansi-green-intense-fg ansi-bold">     10</span> learn<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">.1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 11</span><span class="ansi-red-fg"> </span>test_eq<span class="ansi-blue-fg">(</span>learn<span class="ansi-blue-fg">.</span>metrics<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>value<span class="ansi-blue-fg">+</span>learn<span class="ansi-blue-fg">.</span>metrics<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>value<span class="ansi-blue-fg">,</span> learn<span class="ansi-blue-fg">.</span>loss<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/test.py</span> in <span class="ansi-cyan-fg">test_eq</span><span class="ansi-blue-fg">(a, b)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span> <span class="ansi-green-fg">def</span> test_eq<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     31</span>     <span class="ansi-blue-fg">&#34;`test` that `a==b`&#34;</span>
<span class="ansi-green-fg">---&gt; 32</span><span class="ansi-red-fg">     </span>test<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span>b<span class="ansi-blue-fg">,</span>equals<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;==&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span> 
<span class="ansi-green-intense-fg ansi-bold">     34</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/test.py</span> in <span class="ansi-cyan-fg">test</span><span class="ansi-blue-fg">(a, b, cmp, cname)</span>
<span class="ansi-green-intense-fg ansi-bold">     20</span>     <span class="ansi-blue-fg">&#34;`assert` that `cmp(a,b)`; display inputs and `cname or cmp.__name__` if it fails&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     21</span>     <span class="ansi-green-fg">if</span> cname <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> cname<span class="ansi-blue-fg">=</span>cmp<span class="ansi-blue-fg">.</span>__name__
<span class="ansi-green-fg">---&gt; 22</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">assert</span> cmp<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">f&#34;{cname}:\n{a}\n{b}&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     23</span> 
<span class="ansi-green-intense-fg ansi-bold">     24</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-red-fg">AssertionError</span>: ==:
9.218181610107422
3.954545021057129</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Callbacks">Callbacks<a class="anchor-link" href="#Callbacks">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NBeatsAttention" class="doc_header"><code>class</code> <code>NBeatsAttention</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/nbeats/metrics.py#L86" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NBeatsAttention</code>() :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span><span class="mi">25</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">550</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span><span class="o">-</span><span class="mi">56</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:])</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_items</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">horizon</span> <span class="o">=</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">after_batch</span> <span class="o">=</span> <span class="n">NormalizeTS</span><span class="p">()</span>
                               <span class="p">)</span>
<span class="n">stack_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;trend&#39;</span><span class="p">,</span><span class="s1">&#39;seaonality&#39;</span><span class="p">)</span>
<span class="n">thetas_dim</span><span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mdl</span> <span class="o">=</span> <span class="n">NBeatsNet</span><span class="p">(</span><span class="n">device</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">stack_types</span><span class="o">=</span><span class="n">stack_types</span><span class="p">,</span> <span class="n">nb_blocks_per_stack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">,</span> <span class="n">thetas_dim</span><span class="o">=</span><span class="n">thetas_dim</span><span class="p">)</span>
<span class="n">loss_func</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span> <span class="n">Adam</span><span class="p">,</span> 
                <span class="n">cbs</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">NBeatsTrainer</span><span class="p">(),</span> <span class="n">NBeatsAttention</span><span class="p">()</span>
                     <span class="p">)</span>
               <span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">n_beats_attention</span><span class="o">.</span><span class="n">means</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Need to pad 2/3 time series due to length.
Train:52; Valid: 33; Test 3
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>6.805801</td>
      <td>22.905333</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>5.195472</td>
      <td>60.152649</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>8.558982</td>
      <td>4.170313</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>trend0_0</th>
      <th>seaonality1_0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>theta_0_mean</th>
      <td>-2.5696405e-34</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>theta_0_std</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>theta_1_mean</th>
      <td>-2.5696506e-34</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>theta_1_std</th>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>theta_2_mean</th>
      <td>-2.5696603e-34</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>theta_2_std</th>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>theta_3_mean</th>
      <td>1.1064408e-34</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>theta_3_std</th>
      <td>6.1486e-41</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>att_mean</th>
      <td>5.06918e-17</td>
      <td>1</td>
    </tr>
    <tr>
      <th>att_std</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NBeatsBLoss" class="doc_header"><code>class</code> <code>NBeatsBLoss</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/nbeats/metrics.py#L110" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NBeatsBLoss</code>(<strong><code>alpha</code></strong>=<em><code>1</code></em>) :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span><span class="mi">30</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="mi">550</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span><span class="o">-</span><span class="mi">56</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:])</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_items</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">horizon</span> <span class="o">=</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">after_batch</span> <span class="o">=</span> <span class="n">NormalizeTS</span><span class="p">()</span>
                               <span class="p">)</span>
<span class="n">stack_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;trend&#39;</span><span class="p">,</span><span class="s1">&#39;seaonality&#39;</span><span class="p">)</span>
<span class="n">thetas_dim</span><span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mdl</span> <span class="o">=</span> <span class="n">NBeatsNet</span><span class="p">(</span><span class="n">device</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">stack_types</span><span class="o">=</span><span class="n">stack_types</span><span class="p">,</span> <span class="n">nb_blocks_per_stack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="n">lookback</span><span class="p">,</span> <span class="n">thetas_dim</span><span class="o">=</span><span class="n">thetas_dim</span><span class="p">)</span>
<span class="n">loss_func</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mdl</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span> <span class="n">Adam</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">smape</span><span class="p">,</span><span class="n">NBeatsBackwards</span><span class="p">()],</span>
                <span class="n">cbs</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">NBeatsTrainer</span><span class="p">(),</span> <span class="n">NBeatsAttention</span><span class="p">(),</span> <span class="n">NBeatsBLoss</span><span class="p">(</span><span class="o">.</span><span class="mi">7</span><span class="p">)</span>
                     <span class="p">)</span>
               <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Need to pad 1/3 time series due to length.
Train:286; Valid: 33; Test 3
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>smape</th>
      <th>b_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>4.679620</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-42-c2b8a4395cba&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">10</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">.3</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    287</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    288</span>                         self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch<span class="ansi-blue-fg">;</span>          self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_epoch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 289</span><span class="ansi-red-fg">                         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    290</span>                         self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    291</span>                     <span class="ansi-green-fg">except</span> CancelEpochException<span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_epoch&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_train</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    263</span>             self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dls<span class="ansi-blue-fg">.</span>train<span class="ansi-blue-fg">;</span>                  self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 264</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    265</span>         <span class="ansi-green-fg">except</span> CancelTrainException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    266</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>                                             self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_train&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    241</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 242</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span> 
<span class="ansi-green-intense-fg ansi-bold">    244</span>     <span class="ansi-green-fg">def</span> one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> i<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">one_batch</span><span class="ansi-blue-fg">(self, i, b)</span>
<span class="ansi-green-intense-fg ansi-bold">    248</span>             self<span class="ansi-blue-fg">.</span>pred <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>xb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_pred&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    249</span>             <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span>
<span class="ansi-green-fg">--&gt; 250</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>loss_func<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>pred<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_loss&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span>             <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>training<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span>
<span class="ansi-green-intense-fg ansi-bold">    252</span>             self<span class="ansi-blue-fg">.</span>loss<span class="ansi-blue-fg">.</span>backward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                            self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_backward&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    221</span>     <span class="ansi-green-fg">def</span> ordered_cbs<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> cb_func<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>cb <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>cb<span class="ansi-blue-fg">,</span> cb_func<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    222</span> 
<span class="ansi-green-fg">--&gt; 223</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> L<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_call_one<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    224</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    225</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">map</span><span class="ansi-blue-fg">(self, f, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    360</span>              <span class="ansi-green-fg">else</span> f<span class="ansi-blue-fg">.</span>format <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span>str<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    361</span>              else f.__getitem__)
<span class="ansi-green-fg">--&gt; 362</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>map<span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    363</span> 
<span class="ansi-green-intense-fg ansi-bold">    364</span>     <span class="ansi-green-fg">def</span> filter<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">_new</span><span class="ansi-blue-fg">(self, items, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    313</span>     <span class="ansi-blue-fg">@</span>property
<span class="ansi-green-intense-fg ansi-bold">    314</span>     <span class="ansi-green-fg">def</span> _xtra<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">--&gt; 315</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> _new<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> items<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> type<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> use_list<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    316</span>     <span class="ansi-green-fg">def</span> __getitem__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_get<span class="ansi-blue-fg">(</span>idx<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> is_indexer<span class="ansi-blue-fg">(</span>idx<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> L<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_get<span class="ansi-blue-fg">(</span>idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> use_list<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    317</span>     <span class="ansi-green-fg">def</span> copy<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">.</span>copy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(cls, x, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     39</span>             <span class="ansi-green-fg">return</span> x
<span class="ansi-green-intense-fg ansi-bold">     40</span> 
<span class="ansi-green-fg">---&gt; 41</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     42</span>         res<span class="ansi-blue-fg">.</span>_newchk <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">0</span>
<span class="ansi-green-intense-fg ansi-bold">     43</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, items, use_list, match, *rest)</span>
<span class="ansi-green-intense-fg ansi-bold">    304</span>         <span class="ansi-green-fg">if</span> items <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> items <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    305</span>         <span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">(</span>use_list <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> <span class="ansi-green-fg">not</span> _is_array<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 306</span><span class="ansi-red-fg">             </span>items <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> use_list <span class="ansi-green-fg">else</span> _listify<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    307</span>         <span class="ansi-green-fg">if</span> match <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    308</span>             <span class="ansi-green-fg">if</span> is_coll<span class="ansi-blue-fg">(</span>match<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> match <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>match<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">_listify</span><span class="ansi-blue-fg">(o)</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span>     <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> o
<span class="ansi-green-intense-fg ansi-bold">    241</span>     <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> _is_array<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 242</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">if</span> is_iter<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> list<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    243</span>     <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    244</span> 

<span class="ansi-green-fg">~/dev/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span>             <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">,</span>_Arg<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> args<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    207</span>         fargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>args<span class="ansi-blue-fg">[</span>x<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> _Arg<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> x <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>pargs<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>maxi<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 208</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>fn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>fargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    209</span> 
<span class="ansi-green-intense-fg ansi-bold">    210</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_call_one</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    224</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    225</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 226</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">[</span>cb<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    227</span> 
<span class="ansi-green-intense-fg ansi-bold">    228</span>     <span class="ansi-green-fg">def</span> _bn_bias_state<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> bn_bias_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    224</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    225</span>         <span class="ansi-green-fg">assert</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 226</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">[</span>cb<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> sort_by_run<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    227</span> 
<span class="ansi-green-intense-fg ansi-bold">    228</span>     <span class="ansi-green-fg">def</span> _bn_bias_state<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> bn_bias_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">     23</span>         _run = (event_name not in _inner_loop or (self.run_train and getattr(self, &#39;training&#39;, True)) or
<span class="ansi-green-intense-fg ansi-bold">     24</span>                (self.run_valid and not getattr(self, &#39;training&#39;, False)))
<span class="ansi-green-fg">---&gt; 25</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>run <span class="ansi-green-fg">and</span> _run<span class="ansi-blue-fg">:</span> getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">,</span> noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span> 
<span class="ansi-green-intense-fg ansi-bold">     27</span>     <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">&lt;ipython-input-40-dbe41c6cc813&gt;</span> in <span class="ansi-cyan-fg">after_loss</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     <span class="ansi-green-fg">def</span> after_loss<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-red-fg">#         print(&#39;pre&#39;,self.learn.loss,self.n_beats_trainer.out[&#39;total_b_loss&#39;].mean())</span>
<span class="ansi-green-fg">----&gt; 6</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>learn<span class="ansi-blue-fg">.</span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>learn<span class="ansi-blue-fg">.</span>loss <span class="ansi-blue-fg">+</span> self<span class="ansi-blue-fg">.</span>n_beats_trainer<span class="ansi-blue-fg">.</span>out<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;total_b_loss&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>alpha
<span class="ansi-green-intense-fg ansi-bold">      7</span> <span class="ansi-red-fg">#         print(&#39;after&#39;,self.learn.loss)</span>

<span class="ansi-red-fg">AttributeError</span>: &#39;dict&#39; object has no attribute &#39;mean&#39;</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

