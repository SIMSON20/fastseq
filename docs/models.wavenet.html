---

title: Wavenet model

keywords: fastai
sidebar: home_sidebar

summary: "The WaveNet` architecture for time series forecasting. <https://arxiv.org/pdf/1609.03499.pdf>"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_models.wavenet.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ConcreteDropout" class="doc_header"><code>class</code> <code>ConcreteDropout</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/models/wavenet.py#L13" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ConcreteDropout</code>(<strong><code>dropout_regularizer</code></strong>=<em><code>1e-05</code></em>, <strong><code>init_range</code></strong>=<em><code>(0.1, 0.3)</code></em>, <strong><code>channel_wise</code></strong>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Applies Dropout to the input, even at prediction time and learns dropout probability
from the data.</p>
<p>In convolutional neural networks, we can use dropout to drop entire channels using
the 'channel_wise' argument.</p>
<p>Arguments:</p>

<pre><code>* dropout_regularizer (float): Should  be set to 2 / N, where N is the number of training examples.
* init_range (tuple): Initial range for dropout probabilities.
* channel_wise (boolean): apply dropout over all input or across convolutional channels.</code></pre>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WaveNet" class="doc_header"><code>class</code> <code>WaveNet</code><a href="https://github.com/takotab/fastseq/tree/master/fastseq/models/wavenet.py#L93" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WaveNet</code>(<strong><code>input_channels</code></strong>, <strong><code>output_channels</code></strong>, <strong><code>horizon</code></strong>, <strong><code>hidden_channels</code></strong>=<em><code>64</code></em>, <strong><code>skip_channels</code></strong>=<em><code>64</code></em>, <strong><code>n_layers</code></strong>=<em><code>7</code></em>, <strong><code>n_blocks</code></strong>=<em><code>1</code></em>, <strong><code>dilation</code></strong>=<em><code>2</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Implements <a href="models.wavenet.html#WaveNet"><code>WaveNet</code></a> architecture for time series forecasting. Inherits
from pytorch <code>Module &lt;https://pytorch.org/docs/stable/nn.html#torch.nn.Module&gt;</code>_.
Vector forecasts are made via a fully-connected linear layer.
References:</p>

<pre><code>- `WaveNet: A Generative Model for Raw Audio &lt;https://arxiv.org/pdf/1609.03499.pdf&gt;`_

</code></pre>
<p>Arguments:</p>

<pre><code>* input_channels (int): Number of covariates in input time series.
* output_channels (int): Number of target time series.
* horizon (int): Number of time steps to forecast.
* hidden_channels (int): Number of channels in convolutional hidden layers.
* skip_channels (int): Number of channels in convolutional layers for skip connections.
* n_layers (int): Number of layers per Wavenet block (determines receptive field size).
* n_blocks (int): Number of Wavenet blocks.
* dilation (int): Dilation factor for temporal convolution.</code></pre>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Test">Test<a class="anchor-link" href="#Test">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastseq.data.load</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastseq.data.transforms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai2.data.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">horizon</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">lookback</span> <span class="o">=</span> <span class="mi">128</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">lenghts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>
<span class="n">data_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="n">l</span><span class="p">]),</span>
              <span class="n">t</span><span class="p">[:</span><span class="n">l</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()),</span>
             <span class="p">])</span>
              <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lenghts</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_train</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(2, 20), (2, 10), (2, 140), (2, 140), (2, 200)]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ts_ds</span> <span class="o">=</span> <span class="n">TimeSeriesDataset</span><span class="p">(</span>
    <span class="n">data_train</span><span class="p">,</span>
    <span class="n">lookback</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">static_covs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">ToTensor</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">ts_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
    <span class="n">ts_ds</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Dropped 1/5 time series due to length.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">WaveNet</span><span class="p">(</span><span class="n">input_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">output_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
               <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of model parameters: </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">n_parameters</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Receptive field size: </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">receptive_field_size</span><span class="p">))</span>

<span class="n">optim</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.0008097436666349985</span><span class="p">)</span>

<span class="c1"># # .. and the loss</span>
<span class="c1"># loss = torch.distributions.StudentT</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of model parameters: 125076.
Receptive field size: 128.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">DataBunch</span><span class="p">(</span><span class="n">ts_dl</span><span class="p">,</span> <span class="n">ts_dl</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">Adam</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.callback.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-29-bd8b18fd11a5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">from</span> fastai2<span class="ansi-blue-fg">.</span>callback<span class="ansi-blue-fg">.</span>all <span class="ansi-green-fg">import</span> <span class="ansi-blue-fg">*</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>lr_find<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/callback/schedule.py</span> in <span class="ansi-cyan-fg">lr_find</span><span class="ansi-blue-fg">(self, start_lr, end_lr, num_it, stop_div, show_plot)</span>
<span class="ansi-green-intense-fg ansi-bold">    195</span>     n_epoch <span class="ansi-blue-fg">=</span> num_it<span class="ansi-blue-fg">//</span>len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dbunch<span class="ansi-blue-fg">.</span>train_dl<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> <span class="ansi-cyan-fg">1</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span>     cb<span class="ansi-blue-fg">=</span>LRFinder<span class="ansi-blue-fg">(</span>start_lr<span class="ansi-blue-fg">=</span>start_lr<span class="ansi-blue-fg">,</span> end_lr<span class="ansi-blue-fg">=</span>end_lr<span class="ansi-blue-fg">,</span> num_it<span class="ansi-blue-fg">=</span>num_it<span class="ansi-blue-fg">,</span> stop_div<span class="ansi-blue-fg">=</span>stop_div<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 197</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">with</span> self<span class="ansi-blue-fg">.</span>no_logging<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>n_epoch<span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span>cb<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    198</span>     <span class="ansi-green-fg">if</span> show_plot<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>recorder<span class="ansi-blue-fg">.</span>plot_lr_find<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    287</span>                         self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch<span class="ansi-blue-fg">;</span>          self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_epoch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 288</span><span class="ansi-red-fg">                         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span>                         self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    290</span>                     <span class="ansi-green-fg">except</span> CancelEpochException<span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_epoch&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_train</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    261</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span>             self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dbunch<span class="ansi-blue-fg">.</span>train_dl<span class="ansi-blue-fg">;</span>                  self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 263</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    264</span>         <span class="ansi-green-fg">except</span> CancelTrainException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    265</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>                                             self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_train&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 241</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    242</span> 
<span class="ansi-green-intense-fg ansi-bold">    243</span>     <span class="ansi-green-fg">def</span> one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> i<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/data/load.py</span> in <span class="ansi-cyan-fg">__iter__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     95</span>         self<span class="ansi-blue-fg">.</span>randomize<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     96</span>         self<span class="ansi-blue-fg">.</span>before_iter<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 97</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> b <span class="ansi-green-fg">in</span> _loaders<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>fake_l<span class="ansi-blue-fg">.</span>num_workers<span class="ansi-blue-fg">==</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>fake_l<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     98</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>device <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> b <span class="ansi-blue-fg">=</span> to_device<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>device<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     99</span>             <span class="ansi-green-fg">yield</span> self<span class="ansi-blue-fg">.</span>after_batch<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/env3.7/lib/python3.7/site-packages/torch/utils/data/dataloader.py</span> in <span class="ansi-cyan-fg">__next__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    817</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    818</span>                 <span class="ansi-green-fg">del</span> self<span class="ansi-blue-fg">.</span>_task_info<span class="ansi-blue-fg">[</span>idx<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 819</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_process_data<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    820</span> 
<span class="ansi-green-intense-fg ansi-bold">    821</span>     next <span class="ansi-blue-fg">=</span> __next__  <span class="ansi-red-fg"># Python 2 compatibility</span>

<span class="ansi-green-fg">~/dev/env3.7/lib/python3.7/site-packages/torch/utils/data/dataloader.py</span> in <span class="ansi-cyan-fg">_process_data</span><span class="ansi-blue-fg">(self, data)</span>
<span class="ansi-green-intense-fg ansi-bold">    844</span>         self<span class="ansi-blue-fg">.</span>_try_put_index<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    845</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> ExceptionWrapper<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 846</span><span class="ansi-red-fg">             </span>data<span class="ansi-blue-fg">.</span>reraise<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    847</span>         <span class="ansi-green-fg">return</span> data
<span class="ansi-green-intense-fg ansi-bold">    848</span> 

<span class="ansi-green-fg">~/dev/env3.7/lib/python3.7/site-packages/torch/_utils.py</span> in <span class="ansi-cyan-fg">reraise</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    383</span>             <span class="ansi-red-fg"># (https://bugs.python.org/issue2651), so we work around it.</span>
<span class="ansi-green-intense-fg ansi-bold">    384</span>             msg <span class="ansi-blue-fg">=</span> KeyErrorMessage<span class="ansi-blue-fg">(</span>msg<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 385</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> self<span class="ansi-blue-fg">.</span>exc_type<span class="ansi-blue-fg">(</span>msg<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">RuntimeError</span>: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File &#34;/home/tako/dev/env3.7/lib/python3.7/site-packages/torch/utils/data/_utils/worker.py&#34;, line 178, in _worker_loop
    data = fetcher.fetch(index)
  File &#34;/home/tako/dev/env3.7/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py&#34;, line 34, in fetch
    data = next(self.dataset_iter)
  File &#34;/home/tako/dev/fastai2/fastai2/data/load.py&#34;, line 106, in create_batches
    yield from map(self.do_batch, self.chunkify(res))
  File &#34;/home/tako/dev/fastcore/fastcore/utils.py&#34;, line 250, in chunked
    res = list(itertools.islice(it, cs))
  File &#34;/home/tako/dev/fastai2/fastai2/data/load.py&#34;, line 119, in do_item
    try: return self.after_item(self.create_item(s))
  File &#34;/home/tako/dev/fastai2/fastai2/data/load.py&#34;, line 125, in create_item
    def create_item(self, s):  return next(self.it) if s is None else self.dataset[s]
  File &#34;../fastseq/data/load.py&#34;, line 113, in __getitem__
    print(&#39;applying transform&#39;)
  File &#34;/home/tako/dev/fastcore/fastcore/transform.py&#34;, line 61, in __call__
    def __call__(self, x, **kwargs): return self._call(&#39;encodes&#39;, x, **kwargs)
  File &#34;/home/tako/dev/fastcore/fastcore/transform.py&#34;, line 69, in _call
    if self.use_as_item or not is_listy(x): return self._do_call(f, x, **kwargs)
  File &#34;/home/tako/dev/fastcore/fastcore/transform.py&#34;, line 74, in _do_call
    return x if f is None else retain_type(f(x, **kwargs), x, f.returns_none(x))
  File &#34;/home/tako/dev/fastcore/fastcore/dispatch.py&#34;, line 98, in __call__
    return f(*args, **kwargs)
  File &#34;../fastseq/data/transforms.py&#34;, line 12, in encodes
    return tensor(o)
  File &#34;/home/tako/dev/fastai2/fastai2/torch_core.py&#34;, line 111, in tensor
    else as_tensor(x, **kwargs) if hasattr(x, &#39;__array__&#39;) or is_iter(x)
RuntimeError: Could not infer dtype of dict
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

