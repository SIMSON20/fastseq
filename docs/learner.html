---

title: Learner

keywords: fastai
sidebar: home_sidebar

summary: "A learner for time-series."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/09_learner.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ts_learner</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="n">TSDataBunch</span><span class="p">,</span> <span class="n">base_arch</span><span class="p">:</span><span class="n">Callable</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> 
                  <span class="n">cut</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="n">Callable</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pretrained</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lin_ftrs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                  <span class="n">ps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">custom_head</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                  <span class="n">bn_final</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">kaiming_normal_</span><span class="p">,</span> <span class="n">concat_pool</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                  <span class="n">padding_mode</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Learner</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Create a learner to apply a CNN model to Time series.&#39;&#39;&#39;</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">base_arch</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="n">pretrained</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">MSELossFlat</span><span class="p">(),</span> <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ps&#39;</span><span class="p">:</span><span class="n">ps</span><span class="p">,</span>
                        <span class="s1">&#39;custom_head&#39;</span><span class="p">:</span><span class="n">custom_head</span><span class="p">,</span> <span class="s1">&#39;bn_final&#39;</span><span class="p">:</span><span class="n">bn_final</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">:</span><span class="n">init</span><span class="p">,</span>
                        <span class="s1">&#39;concat_pool&#39;</span><span class="p">:</span><span class="n">concat_pool</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>
<span class="c1">#     channels = _calc_channels(data)</span>
    <span class="n">adapt_model</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="n">pretrained</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">init</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="n">padding_mode</span><span class="p">)</span>
<span class="c1">#     learn.unfreeze() # Model shouldn&#39;t be frozen, unlike vision</span>
    <span class="k">return</span> <span class="n">learn</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-013abdef2f76&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> def ts_learner(data:TSDataBunch, base_arch:Callable=models.resnet18, metrics=accuracy, 
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                   cut<span class="ansi-blue-fg">:</span>Union<span class="ansi-blue-fg">[</span>int<span class="ansi-blue-fg">,</span>Callable<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> pretrained<span class="ansi-blue-fg">:</span>bool<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> lin_ftrs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>                   ps<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.5</span><span class="ansi-blue-fg">,</span> custom_head<span class="ansi-blue-fg">:</span>Optional<span class="ansi-blue-fg">[</span>nn<span class="ansi-blue-fg">.</span>Module<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> split_on<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>                   bn_final<span class="ansi-blue-fg">:</span>bool<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> init<span class="ansi-blue-fg">=</span>nn<span class="ansi-blue-fg">.</span>init<span class="ansi-blue-fg">.</span>kaiming_normal_<span class="ansi-blue-fg">,</span> concat_pool<span class="ansi-blue-fg">:</span>bool<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>                   padding_mode:str=&#39;zeros&#39;, **kwargs) -&gt; Learner:

<span class="ansi-red-fg">NameError</span>: name &#39;models&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Intergration-Example">Intergration Example<a class="anchor-link" href="#Intergration-Example">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">m4_daily</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">TSDataBunch</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">ts_learner</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-6c1072437515&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> path <span class="ansi-blue-fg">=</span> untar_data<span class="ansi-blue-fg">(</span>URLs<span class="ansi-blue-fg">.</span>m4_daily<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> data <span class="ansi-blue-fg">=</span> TSDataBunch<span class="ansi-blue-fg">.</span>from_folder<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">,</span> nrows<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">100</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span>learn <span class="ansi-blue-fg">=</span> ts_learner<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ts_learner&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1017.1, 1019.3, 1017. , 1019.2, 1018.7, 1015.6, 1018.5, 1018.3,
        1018.4, 1021.5, 1023. , 1023.3, 1020.5, 1021.4, 1018.1, 1022.6,
        1022.6, 1021. , 1020.1, 1017. , 1019.3, 1017.3, 1016.1, 1017.8,
        1019.3, 1025.1, 1024.8, 1025.1, 1025.1, 1022.6, 1021.2, 1017.2,
        1041.5, 1041.7, 1038.9, 1041. , 1042.9, 1042.1, 1043.9, 1039. ,
        1037.3, 1033.7, 1032.5, 1036.3, 1037.5, 1040. , 1038.4, 1035.3,
        1032. , 1028.1, 1032.2, 1030.2, 1031.2, 1032.8, 1030.3, 1030.2,
        1028.1, 1022.1, 1024.4, 1023.4, 1026.3, 1024. , 1026.1, 1031. ,
        1037.6, 1036.6, 1037.4, 1035.4, 1038.9, 1038.7, 1036.5, 1036.4,
        1036.8, 1035.3, 1032.6, 1029.3, 1031.3, 1027.4, 1028.6, 1025.8,
        1026. , 1022.3, 1020.1, 1017.7, 1018. , 1023.2, 1024.2, 1020.5,
        1022.2, 1025.3, 1023.3, 1035.3, 1036.7, 1035.1, 1032.5, 1028.7,
        1028.1, 1025.6, 1027.9, 1025. , 1025.7, 1025. , 1023.7, 1025.5,
        1025.8, 1030.5, 1035.1, 1034.2, 1032.2, 1033.6, 1045.6, 1040.3,
        1035.9, 1035.4, 1031. , 1035.1, 1022.1, 1020.4, 1019.6, 1023.2,
        1016.5, 1011.6, 1013.9, 1011.3, 1020.9, 1023.4, 1019.6, 1016.7,
        1012. , 1012.7, 1010.7, 1002.5,  991.5,  992.9,  997.1, 1001.6,
         997.2, 1001.9, 1011.7, 1005.7, 1018.7, 1016.5, 1018.3, 1014.8,
        1011. , 1018.7, 1009.9, 1012.7, 1015. , 1010.4, 1099. , 1095.2,
        1098.1, 1094.8, 1097.9, 1085.2, 1086. , 1088.2, 1088.6, 1085.8,
        1080.4, 1077.2, 1075.7, 1080.3, 1081.6, 1080.3, 1094.8, 1097.2,
        1096.2, 1095.4, 1093. , 1084.3, 1079.6, 1080.8, 1083.2, 1086.6,
        1078.6, 1078.3, 1077.1, 1080.3, 1082.6, 1079.7, 1083.5, 1080. ,
        1079.4, 1079.4, 1082.1, 1080.8, 1077.5, 1079.7, 1078.8, 1083.1,
        1079.7, 1078.1, 1077.3, 1075.5, 1080.2, 1090.3, 1089.6, 1087.8,
        1081.1, 1071.7, 1071.4, 1069.8, 1070.5, 1066.4, 1070.9, 1065.5,
        1068.6, 1067.1, 1068.3, 1074.9, 1069.2, 1068.6, 1076.2, 1080.7,
        1077.7, 1077.6, 1083.7, 1084.4, 1084.4, 1091.4, 1090.4, 1096.5,
        1095. , 1096.9, 1099.8, 1096.1, 1094.3, 1098.9, 1099. , 1101.5,
        1111.4, 1114.1, 1112.8, 1116.4, 1117.3, 1115. , 1113.1, 1114.6,
        1118.2, 1117.8, 1116.3, 1116. , 1115.9, 1114.9, 1117.5, 1116.3,
        1115.7, 1119.4, 1118.6, 1119.8, 1120.1, 1111.6, 1106.9, 1107.5,
        1125.3, 1126.1, 1124.2, 1122.1, 1126.7, 1118.5, 1118.5, 1119.9,
        1116. , 1117.5, 1115.3, 1114.5, 1117.7, 1109.1, 1107.7, 1106.6,
        1104.6, 1109.9, 1108.7, 1108.7, 1106.4, 1113.9, 1112.2, 1112.3,
        1117.7, 1118.5, 1119.5, 1117.4, 1117. , 1112.5, 1136.2, 1130.8,
        1127.2, 1118.5, 1115.2, 1116.5, 1119.2, 1116.8, 1115.8, 1114.7,
        1117.4, 1116.6, 1115.4, 1109.5, 1088.6, 1090. , 1078.4, 1091.6,
        1096.3, 1200.3, 1199.6, 1192.8, 1192.7, 1203.9, 1199.6, 1209.2,
        1206. , 1206.7, 1210.7, 1204. , 1193.6, 1196.5, 1197.2, 1194.3,
        1197.5, 1192.2, 1194.7, 1192.8, 1203. , 1213.6, 1209.6, 1209.5,
        1205.2, 1193.8, 1192.6, 1203.4, 1210.5, 1199.9, 1203.4, 1211.7,
        1206. , 1211. , 1214.9, 1211. , 1213.5, 1214. , 1209.9, 1212.8,
        1216. , 1232.4, 1255.6, 1253.1, 1256.1, 1251.4, 1259.9, 1258.5,
        1262.5, 1261.7, 1269.9, 1259.5, 1233.2, 1234.4, 1236.9, 1235.2,
        1262.2, 1249.4, 1252.1, 1251.8, 1258.4, 1252.2, 1252.9, 1250.1,
        1257.1, 1258. , 1257.4, 1254.7, 1253.7, 1253.4, 1249.9, 1256.3,
        1253.7, 1255.1, 1258.8, 1264.8, 1258.4, 1256.6, 1255.6, 1258.3,
        1258.6, 1260.3, 1264.9, 1266.7, 1270.2, 1272.6, 1263.7, 1267.3,
        1265.8, 1262.6, 1261.6, 1265.6, 1263.9, 1264.5, 1268.2, 1264.8,
        1264.9, 1262.2, 1265.7, 1267. , 1271.8, 1274.3, 1274.5, 1282.7,
        1282.7, 1284.8, 1293.4, 1296.7, 1305. , 1319.8, 1327.8, 1323.9,
        1325.4, 1331.7, 1330.6, 1328. , 1326.6, 1327.5, 1331.6, 1327.7,
        1330.9, 1326.6, 1331.3, 1337.1, 1339.2, 1345. , 1334.7, 1341.3,
        1346.8, 1348.7, 1351.6, 1349.7, 1349.7, 1348.9, 1332.3, 1323.4,
        1326.5, 1330.7, 1329.9, 1323.3, 1325. , 1333. , 1332.1, 1337.4,
        1341.4, 1338.8, 1336.1, 1340.6, 1341.9, 1340.9, 1342.1, 1340.1,
        1343.2, 1338.4, 1341.4, 1339.9, 1330. , 1334.5, 1337.6, 1334.2,
        1345.5, 1346.1, 1345.7, 1353.5, 1356.2, 1352.2, 1352.8, 1351.6,
        1356.6, 1353.6, 1355. , 1358.5, 1350.3, 1354.2, 1353.1, 1360.6,
        1357.4, 1356.2, 1359.7, 1357. , 1363.2, 1368.8, 1371.9, 1375.8,
        1382.1, 1378.6, 1378.3, 1378.1, 1383.2, 1386.5, 1389.6, 1391.1,
        1397.4, 1399.8, 1392.1, 1389.9, 1388.5, 1395.1, 1394.5, 1398.1,
        1394.3, 1395.5, 1394.7, 1395.8, 1397. , 1402.5, 1399.4, 1393. ,
        1395.9, 1392.1, 1392.2, 1402.1, 1404.2, 1413.8, 1418.3, 1423.6,
        1431.3, 1435.7, 1433.9, 1441.6, 1441.6, 1450.6, 1454.7, 1450. ,
        1453.1, 1452.6, 1450.5, 1445.9, 1442.3, 1445.7, 1450.2, 1447.7,
        1444.9, 1448. , 1446.1, 1446.5, 1446.9, 1437.4, 1439. , 1439.1,
        1441. , 1442.4, 1436.1, 1438. , 1437.7, 1446.2, 1454.3, 1450.9,
        1452.4, 1451. , 1459. , 1456.2, 1460.9, 1461.9, 1459.8, 1459.1,
        1458.2, 1462. , 1459.7, 1463.1, 1466.5, 1463. , 1463.3, 1468.8,
        1471.1, 1467.2, 1470.4, 1469.1, 1470.8, 1471.7, 1471.1, 1473.5,
        1482.1, 1485.6, 1484.9, 1489.1, 1490.2, 1490.2, 1490.8, 1487.6,
        1495.7, 1495.9, 1497.6, 1502.8, 1507.2, 1502.1, 1508.9, 1512.8,
        1511. , 1508.9, 1509.6, 1510.9, 1509.1, 1509. , 1517.8, 1518.7,
        1518.9, 1522.2, 1519.4, 1522.8, 1523.9, 1526.3, 1528.1, 1526.6,
        1530. , 1530.2, 1523.5, 1525.4, 1518.4, 1520.3, 1523.7, 1524.7,
        1525.2, 1530.4, 1530.5, 1531.3, 1532.3, 1527. , 1523.6, 1521. ,
        1522.4, 1528.3, 1530.1, 1535.2, 1534.8, 1533.4, 1535.1, 1530.5,
        1532. , 1534.1, 1535.8, 1532.6, 1536.7, 1539.2, 1538.6, 1539.2,
        1541.4, 1538.7, 1541.4, 1534.4, 1523.3, 1526.5, 1526.8, 1526.9,
        1523.4, 1526.3, 1528.4, 1524.3, 1528.1, 1526.2, 1519.7, 1524.8,
        1530.3, 1528.9, 1535.6, 1536.1, 1540.6, 1534.8, 1533.5, 1535.9,
        1542.3, 1544.3, 1544.6, 1542.9, 1545.7, 1548.2, 1541.7, 1539.6,
        1544.2, 1544.7, 1546.5, 1547.1, 1550.3, 1549.2, 1549.4, 1551.9,
        1556.6, 1564.1, 1570.5, 1570.4, 1572.9, 1572.3, 1572. , 1573.9,
        1573.2, 1575.8, 1574. , 1571.8, 1567.3, 1574.2, 1580.2, 1583.5,
        1582.8, 1583. , 1589.1, 1588.2, 1588.4, 1584.7, 1586.8, 1591.6,
        1588.8, 1589.2, 1591.9, 1595.6, 1598. , 1599.1, 1599.6, 1595.4,
        1589.3, 1592.4, 1591.6, 1585.9, 1587.9, 1586.6, 1591. , 1589.7,
        1589.3, 1595.6, 1592.1, 1592.3, 1589.3, 1583.6, 1591.4, 1590.8,
        1591.5, 1591. , 1589.5, 1587.2, 1586.7, 1589.7, 1596.5, 1605.1,
        1606.2, 1613.1, 1614.5, 1617.8, 1633.7, 1632.8, 1636.4, 1624.4,
        1631. , 1634.9, 1628.6, 1632.4, 1632. , 1638.8, 1635.5, 1640.9,
        1646.7, 1649.2, 1647.4, 1648.4, 1651.3, 1649.3, 1610.6, 1609.6,
        1624.9, 1622.3, 1628.9, 1636.1, 1637.7, 1641.3, 1646.7, 1653.5,
        1651. , 1661.7, 1675.9, 1675.2, 1690.6, 1689.2, 1688.5, 1691.1,
        1704.8, 1703.4, 1701.7, 1697. , 1700.4, 1699.5, 1703. , 1710.9,
        1717. , 1712.3, 1722.8, 1732.2, 1740.2, 1743.7, 1749.9, 1756.4,
        1745.3, 1747.5, 1745.5, 1738.9, 1743.2, 1739.3, 1757.7, 1757.7,
        1759.6, 1770.2, 1772.3, 1779.7]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(#3) [0,0.0,&#39;00:00&#39;]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-18-8587f3539821&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    287</span>                         self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch<span class="ansi-blue-fg">;</span>          self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_epoch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 288</span><span class="ansi-red-fg">                         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span>                         self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    290</span>                     <span class="ansi-green-fg">except</span> CancelEpochException<span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_epoch&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_train</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    261</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span>             self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dbunch<span class="ansi-blue-fg">.</span>train_dl<span class="ansi-blue-fg">;</span>                  self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 263</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    264</span>         <span class="ansi-green-fg">except</span> CancelTrainException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    265</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>                                             self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_train&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    240</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 241</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    242</span> 
<span class="ansi-green-intense-fg ansi-bold">    243</span>     <span class="ansi-green-fg">def</span> one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> i<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">one_batch</span><span class="ansi-blue-fg">(self, i, b)</span>
<span class="ansi-green-intense-fg ansi-bold">    245</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    246</span>             self<span class="ansi-blue-fg">.</span>_split<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                                  self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_batch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 247</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>pred <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>xb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_pred&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    248</span>             <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span>
<span class="ansi-green-intense-fg ansi-bold">    249</span>             self<span class="ansi-blue-fg">.</span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>loss_func<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>pred<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_loss&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/env37/lib/python3.7/site-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    540</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 541</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    542</span>         <span class="ansi-green-fg">for</span> hook <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    543</span>             hook_result <span class="ansi-blue-fg">=</span> hook<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">,</span> result<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/env37/lib/python3.7/site-packages/torch/nn/modules/container.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, input)</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span>     <span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     91</span>         <span class="ansi-green-fg">for</span> module <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_modules<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 92</span><span class="ansi-red-fg">             </span>input <span class="ansi-blue-fg">=</span> module<span class="ansi-blue-fg">(</span>input<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     93</span>         <span class="ansi-green-fg">return</span> input
<span class="ansi-green-intense-fg ansi-bold">     94</span> 

<span class="ansi-green-fg">~/dev/env37/lib/python3.7/site-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    540</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 541</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    542</span>         <span class="ansi-green-fg">for</span> hook <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    543</span>             hook_result <span class="ansi-blue-fg">=</span> hook<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">,</span> result<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/env37/lib/python3.7/site-packages/torch/nn/modules/container.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, input)</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span>     <span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     91</span>         <span class="ansi-green-fg">for</span> module <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_modules<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 92</span><span class="ansi-red-fg">             </span>input <span class="ansi-blue-fg">=</span> module<span class="ansi-blue-fg">(</span>input<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     93</span>         <span class="ansi-green-fg">return</span> input
<span class="ansi-green-intense-fg ansi-bold">     94</span> 

<span class="ansi-green-fg">~/dev/env37/lib/python3.7/site-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    539</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    540</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 541</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    542</span>         <span class="ansi-green-fg">for</span> hook <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    543</span>             hook_result <span class="ansi-blue-fg">=</span> hook<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">,</span> result<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/dev/env37/lib/python3.7/site-packages/torch/nn/modules/conv.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, input)</span>
<span class="ansi-green-intense-fg ansi-bold">    343</span> 
<span class="ansi-green-intense-fg ansi-bold">    344</span>     <span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 345</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>conv2d_forward<span class="ansi-blue-fg">(</span>input<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>weight<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    346</span> 
<span class="ansi-green-intense-fg ansi-bold">    347</span> <span class="ansi-green-fg">class</span> Conv3d<span class="ansi-blue-fg">(</span>_ConvNd<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/dev/env37/lib/python3.7/site-packages/torch/nn/modules/conv.py</span> in <span class="ansi-cyan-fg">conv2d_forward</span><span class="ansi-blue-fg">(self, input, weight)</span>
<span class="ansi-green-intense-fg ansi-bold">    340</span>                             _pair(0), self.dilation, self.groups)
<span class="ansi-green-intense-fg ansi-bold">    341</span>         return F.conv2d(input, weight, self.bias, self.stride,
<span class="ansi-green-fg">--&gt; 342</span><span class="ansi-red-fg">                         self.padding, self.dilation, self.groups)
</span><span class="ansi-green-intense-fg ansi-bold">    343</span> 
<span class="ansi-green-intense-fg ansi-bold">    344</span>     <span class="ansi-green-fg">def</span> forward<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">RuntimeError</span>: Expected 4-dimensional input for 4-dimensional weight 64 1 7 7, but got 3-dimensional input of size [16, 1, 3] instead</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># def audio_predict(learn, item:AudioItem):</span>
<span class="c1">#     &#39;&#39;&#39;Applies preprocessing to an AudioItem before predicting its class&#39;&#39;&#39;</span>
<span class="c1">#     al = AudioList([item], path=item.path, config=learn.data.x.config).split_none().label_empty()</span>
<span class="c1">#     ai = AudioList.open(al, item.path)</span>
<span class="c1">#     return learn.predict(ai)   </span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

